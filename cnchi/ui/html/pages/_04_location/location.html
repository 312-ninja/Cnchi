{% extends 'pages/html_page.html' %}

{% from 'pages/_macros.html' import tabbed_navigation, collection_text_only with context %}


{#
 # CSS Styles Specific To This Page
 #}
{% block page_styles %}
	<style>
		body, html, .cnchi_app { background: #FFFFFF; color: #32373c; font-weight: 400; height: 100%; }

		h1, h3 { font-family: Raleway, 'Open Sans', sans-serif; font-size: 22px; text-align: center; font-weight: 400; margin-top: 20px; }

		h3 { font-size: 18px; font-family: 'Open Sans', sans-serif; }

		.heading { text-align: center; margin: 30px 0px; }

		.collection_wrapper .collection { max-height: 280px; overflow: auto; }

		.collection a.collection-item { opacity: 0; cursor: default; padding: 15px 25px; text-align: center; color: #32373c; }

		.collection a.collection-item:not(.active):hover { cursor: default; background-color: #f1f5f9;}
	</style>
{% endblock page_styles %}



{#
 # Page Content (Appears below the header)
 #}
{% block main_content %}
	<div class="grid-100 grid-parent content_wrapper">
	<!-- TAB NAVIGATION BUTTONS -->
	<div class="grid-100 grid-parent navigation_wrapper">
		{{ tabbed_navigation(tabs, '1') }}
	</div> <!-- /END TAB NAVIGATION BUTTONS -->

		<!-- PAGE CONTENT -->
		<div class="grid-100 grid-parent content">

			<!-- LOCATION TAB -->
			<div class="grid-100 grid-parent page_tab">
				<div class="grid-100 heading">
					<h1>{{ _('Please Choose Your Location:') }}</h1>
				</div>
				<div class="grid-60 prefix-20 suffix-20 grid-parent collection_wrapper">
					{{ collection_text_only(locations) }}
				</div>
				<div class="grid-90 prefix-5 suffix-5 grid-parent show_all_locations_wrapper">
					<input type="checkbox" name="show_all_locations">{{ _('Show all locations') }}
				</div>
			</div> <!-- /END LOCATION TAB -->

			<!-- KEYBOARD LAYOUT TAB -->
			<div class="grid-100 grid-parent page_tab">

			</div> <!-- /END KEYBOARD LAYOUT TAB -->

			<!-- TIMEZONE TAB -->
			<div class="grid-100 grid-parent page_tab">

			</div> <!-- /END TIMEZONE TAB -->

		</div> <!-- /END PAGE CONTENT -->
	</div>
{% endblock main_content %}



{#
 # Javascript For This Page
 #}
{% block page_script %}
	<script>
		window._page = null;

		class LocationPage extends CnchiPage {
			constructor( id ) {
				if ( null !== window._page ) {
					return window._page;
				}

				super( id );

				window._page = this;
				this.signals = JSON.parse('{{ signals }}');

				this.$selection_wrapper = $('.selection_wrapper');
				this.$show_all_locations_wrapper = $('.show_all_locations_wrapper');

				this.register_allowed_signals();
				this.initialize();
			}

			initialize() {
				Materialize.showStaggeredList('.collection');

				for ( let signal of this.signals ) {
					if ( signal.indexOf('do-') > -1 ) {
						cnchi.emit_signal(signal);
					}
				}
			}

			register_event_handlers() {
				$('.show_all_locations_wrapper input').on('click', this.show_all_locations_input_clicked_cb);
			}

			show_all_locations_input_clicked_cb( event ) {
				cnchi.emit_signal('do-show-all-locations');
			}
		}

		window.LocationPage = LocationPage;

	</script>
{% endblock page_script %}
